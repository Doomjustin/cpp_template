# Clang-Format 配置文件

# 基础风格
BasedOnStyle: LLVM

# 语言设置
Language: Cpp
Standard: Latest

# 缩进设置
AccessModifierOffset: -4
IndentWidth: 4
TabWidth: 4
UseTab: Never
ContinuationIndentWidth: 4
IndentCaseLabels: false
IndentGotoLabels: true
IndentPPDirectives: None
IndentWrappedFunctionNames: false

# 括号设置
BraceWrapping:
  AfterCaseLabel: false
  AfterClass: false
  AfterControlStatement: Never
  AfterEnum: false
  AfterFunction: true
  AfterNamespace: false
  AfterStruct: false
  AfterUnion: false
  AfterExternBlock: false
  BeforeCatch: false
  BeforeElse: false
  BeforeWhile: false
  IndentBraces: false
  SplitEmptyFunction: false
  SplitEmptyRecord: true
  SplitEmptyNamespace: true

BreakBeforeBraces: Custom

# 换行设置
ColumnLimit: 120
BreakBeforeBinaryOperators: All
AlignOperands: Align
BreakBeforeTernaryOperators: true
BreakConstructorInitializers: BeforeComma
BreakInheritanceList: BeforeColon
BreakStringLiterals: true
CompactNamespaces: false
ConstructorInitializerAllOnOneLineOrOnePerLine: false
ConstructorInitializerIndentWidth: 2

# 空格设置
SpaceAfterCStyleCast: false
SpaceAfterLogicalNot: false
SpaceAfterTemplateKeyword: true
SpaceBeforeAssignmentOperators: true
SpaceBeforeCpp11BracedList: false
SpaceBeforeCtorInitializerColon: true
SpaceBeforeInheritanceColon: true
SpaceBeforeParens: ControlStatements
SpaceBeforeRangeBasedForLoopColon: true
SpaceInEmptyParentheses: false
SpacesBeforeTrailingComments: 2

# 大括号初始化设置
Cpp11BracedListStyle: false
SpacesInCStyleCastParentheses: false
SpacesInContainerLiterals: true
SpacesInParentheses: false
SpacesInSquareBrackets: false

# 大括号内空格设置
SpacesInAngles: false

# 对齐设置
AlignAfterOpenBracket: Align
AlignConsecutiveAssignments: false
AlignConsecutiveDeclarations: false
AlignConsecutiveMacros: false
AlignEscapedNewlines: Left
AlignTrailingComments: true

# 函数设置
AllowAllArgumentsOnNextLine: true
AllowAllConstructorInitializersOnNextLine: false
AllowAllParametersOfDeclarationOnNextLine: true
AllowShortBlocksOnASingleLine: Never
AllowShortCaseLabelsOnASingleLine: false
AllowShortFunctionsOnASingleLine: None
AllowShortIfStatementsOnASingleLine: Never
AllowShortLambdasOnASingleLine: All
AllowShortLoopsOnASingleLine: false
AlwaysBreakAfterDefinitionReturnType: None
AlwaysBreakAfterReturnType: None
AlwaysBreakBeforeMultilineStrings: true
AlwaysBreakTemplateDeclarations: Yes

# C++20 模块设置
RequiresClausePosition: OwnLine
RequiresExpressionIndentation: OuterScope
SeparateDefinitionBlocks: Leave

# Include 排序设置（重点配置）- 反转优先级顺序，带空行分隔
SortIncludes: true
IncludeBlocks: Regroup
IncludeCategories:
  # 项目内头文件（双引号）- 最高优先级
  - Regex: '^".*"'
    Priority: 1
    CaseSensitive: false
  
  # 知名第三方库头文件
  - Regex: '^<(boost|eigen|opencv|qt|gtk|glib|json|yaml|protobuf|grpc|curl|openssl|sqlite|mysql|postgresql|mongo|redis|kafka|aws|azure|google)/'
    Priority: 2
    CaseSensitive: false
  
  # 系统特定头文件（Windows, Linux, 网络、POSIX等）
  - Regex: '^<(windows|winsock2|ws2tcpip|winbase|windef|winuser|wingdi|wincon|wincrypt|winreg|shellapi|shlobj|commdlg|commctrl|richedit|unistd|sys/.*|arpa/.*|netinet/.*|net/.*|pthread|semaphore|mqueue|aio|fcntl|dirent|pwd|grp|termios|syslog|utmp|utime|glob|wordexp|fnmatch|dlfcn|netdb|ifaddrs|poll)\.h>'
    Priority: 3
    CaseSensitive: false
  
  # C++ C 兼容头文件
  - Regex: '^<c(assert|complex|ctype|errno|fenv|float|inttypes|iso646|limits|locale|math|setjmp|signal|stdalign|stdarg|stdatomic|stdbool|stddef|stdint|stdio|stdlib|stdnoreturn|string|tgmath|threads|time|uchar|wchar|wctype)>'
    Priority: 4
    CaseSensitive: false
  
  # C 标准库头文件
  - Regex: '^<(assert|complex|ctype|errno|fenv|float|inttypes|iso646|limits|locale|math|setjmp|signal|stdalign|stdarg|stdatomic|stdbool|stddef|stdint|stdio|stdlib|stdnoreturn|string|tgmath|threads|time|uchar|wchar|wctype)\.h>'
    Priority: 5
    CaseSensitive: false
  
  # C++ 标准库头文件
  - Regex: '^<(algorithm|array|atomic|bitset|charconv|chrono|codecvt|compare|complex|concepts|condition_variable|coroutine|deque|exception|execution|filesystem|format|forward_list|fstream|functional|future|initializer_list|iomanip|ios|iosfwd|iostream|istream|iterator|limits|list|locale|map|memory|memory_resource|mutex|new|numbers|numeric|optional|ostream|queue|random|ranges|ratio|regex|scoped_allocator|set|shared_mutex|source_location|span|sstream|stack|stdexcept|stop_token|streambuf|string|string_view|strstream|syncstream|system_error|thread|tuple|type_traits|typeindex|typeinfo|unordered_map|unordered_set|utility|valarray|variant|vector|version)>'
    Priority: 6
    CaseSensitive: false
  
  # 其他第三方库（尖括号）- 与知名第三方库同优先级
  - Regex: '^<.*>'
    Priority: 2
    CaseSensitive: false

# 主头文件识别模式
IncludeIsMainRegex: '([-_](test|unittest))?$'

# 其他设置
BinPackArguments: true
BinPackParameters: true
CommentPragmas: '^ IWYU pragma:'
DeriveLineEnding: true
DerivePointerAlignment: false
DisableFormat: false
ExperimentalAutoDetectBinPacking: false
FixNamespaceComments: true
ForEachMacros:
  - foreach
  - Q_FOREACH
  - BOOST_FOREACH
IncludeIsMainSourceRegex: ''
IndentExternBlock: AfterExternBlock
InsertTrailingCommas: None
JavaScriptQuotes: Leave
JavaScriptWrapImports: true
KeepEmptyLinesAtTheStartOfBlocks: false
MacroBlockBegin: ''
MacroBlockEnd: ''
MaxEmptyLinesToKeep: 2
NamespaceIndentation: None
ObjCBinPackProtocolList: Never
ObjCBlockIndentWidth: 2
ObjCBreakBeforeNestedBlockParam: true
ObjCSpaceAfterProperty: false
ObjCSpaceBeforeProtocolList: true
PenaltyBreakAssignment: 2
PenaltyBreakBeforeFirstCallParameter: 1
PenaltyBreakComment: 300
PenaltyBreakFirstLessLess: 120
PenaltyBreakString: 1000
PenaltyBreakTemplateDeclaration: 10
PenaltyExcessCharacter: 1000000
PenaltyReturnTypeOnItsOwnLine: 200
PointerAlignment: Left
ReflowComments: true
SortUsingDeclarations: true
StatementMacros:
  - Q_UNUSED
  - QT_REQUIRE_VERSION
UseCRLF: false

# 支持模块导入/导出的语句识别
StatementAttributeLikeMacros:
  - export
  - import
